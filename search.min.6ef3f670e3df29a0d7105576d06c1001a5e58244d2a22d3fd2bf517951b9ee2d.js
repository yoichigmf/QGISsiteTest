var summaryInclude=180,searchQuery,results,fuseOptions={shouldSort:!0,includeMatches:!0,includeScore:!0,tokenize:!0,matchAllTokens:!0,location:0,distance:5e3,threshold:.55,minMatchCharLength:2,keys:[{name:"title",weight:.45},{name:"contents",weight:.4},{name:"tags",weight:.1},{name:"categories",weight:.05}]},inputBox=document.getElementById("search-query");inputBox!==null&&(searchQuery=param("q"),searchQuery?(inputBox.value=searchQuery||"",executeSearch(searchQuery,!1)):(results=document.getElementById("search-results"),results!=null&&(results.innerHTML='<p class="search-results-empty">Please enter a word or phrase above, or see <a href="https://qgis.org/tags/">all tags</a>.</p>')));function executeSearch(e){show(document.querySelector(".search-loading")),fetch("https://qgis.org/index.json").then(function(t){if(t.status!==200){console.log("Looks like there was a problem. Status Code: "+t.status);return}t.json().then(function(t){var s=new Fuse(t,fuseOptions),n=s.search(e);n.length>0?populateResults(n):document.getElementById("search-results").innerHTML='<p class="search-results-empty">No matches found</p>',document.getElementById("search-results").innerHTML==""&&(document.getElementById("search-results").innerHTML='<p class="search-results-empty">No matches found</p>'),hide(document.querySelector(".search-loading"))}).catch(function(e){console.log("Fetch Error :-S",e)})})}function populateResults(e){var t,s,o=document.getElementById("search-query").value,n=document.getElementById("search-results");n.innerHTML="",t=o.split(/\s+/).filter(e=>e.length>0),s=document.getElementById("search-result-template").innerHTML,e.forEach(function(e,o){var i,a,r,d,u=e.item.contents,c="",l=[];l.push(...t),c=createSnippet(u,t),i="",e.item.tags&&e.item.tags.forEach(function(e){i+="<span class='tag is-warning'><a href='/tags/"+e+"'>"+e+"</a></span> "}),a="",e.item.categories&&e.item.categories.forEach(function(e){a+="<span class='tag is-danger'><a href='/categories/"+e+"'>"+e+"</a></span> "}),r=render(s,{key:o,title:e.item.title,link:e.item.permalink,tags:i,categories:a,snippet:c}),d=t.some(e=>r.toLowerCase().includes(e.toLowerCase())),d&&(n.innerHTML+=r,l.forEach(function(e){var t=new Mark(document.getElementById("summary-"+o));t.mark(e)}))})}function createSnippet(e,t){const i=200;let s=0,o=i;t.forEach(t=>{let n=e.toLowerCase().indexOf(t.toLowerCase());n>-1&&(s=Math.max(0,n-50),o=Math.min(e.length,n+i-50))});let n=e.substring(s,o);return s>0&&(n="&hellip;"+n),o<e.length&&(n+="&hellip;"),n}function render(e,t){i=/\$\{\s*isset ([a-zA-Z]*) \s*\}(.*)\$\{\s*end\s*}/g,n=e;for(var n,s,o,i,a,r;(s=i.exec(e))!==null;)t[s[1]]?n=n.replace(s[0],s[2]):n=n.replace(s[0],"");e=n;for(o in t)a="\\$\\{\\s*"+o+"\\s*\\}",r=new RegExp(a,"g"),e=e.replace(r,t[o]);return e}function show(e){e.style.display="block"}function hide(e){e.style.display="none"}function param(e){return decodeURIComponent((location.search.split(e+"=")[1]||"").split("&")[0]).replace(/\+/g," ")}