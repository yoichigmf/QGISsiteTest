"use strict";var qrcodegen;(function(e){class t{constructor(e,n,s,i){if(this.version=e,this.errorCorrectionLevel=n,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version value out of range");if(i<-1||i>7)throw new RangeError("Mask value out of range");this.size=e*4+17;let a=[];for(let e=0;e<this.size;e++)a.push(!1);for(let e=0;e<this.size;e++)this.modules.push(a.slice()),this.isFunction.push(a.slice());this.drawFunctionPatterns();const r=this.addEccAndInterleave(s);if(this.drawCodewords(r),i==-1){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const n=this.getPenaltyScore();n<e&&(i=t,e=n),this.applyMask(t)}}o(0<=i&&i<=7),this.mask=i,this.applyMask(i),this.drawFormatBits(i),this.isFunction=[]}static encodeText(n,s){const o=e.QrSegment.makeSegments(n);return t.encodeSegments(o,s)}static encodeBinary(n,s){const o=e.QrSegment.makeBytes(n);return t.encodeSegments([o],s)}static encodeSegments(e,i,a=1,r=40,c=-1,l=!0){if(!(t.MIN_VERSION<=a&&a<=r&&r<=t.MAX_VERSION)||c<-1||c>7)throw new RangeError("Invalid value");let u,m;for(u=a;;u++){const o=t.getNumDataCodewords(u,i)*8,s=n.getTotalBits(e,u);if(s<=o){m=s;break}if(u>=r)throw new RangeError("Data too long")}for(const e of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])l&&m<=t.getNumDataCodewords(u,e)*8&&(i=e);let d=[];for(const t of e){s(t.mode.modeBits,4,d),s(t.numChars,t.mode.numCharCountBits(u),d);for(const e of t.getData())d.push(e)}o(d.length==m);const f=t.getNumDataCodewords(u,i)*8;o(d.length<=f),s(0,Math.min(4,f-d.length),d),s(0,(8-d.length%8)%8,d),o(d.length%8==0);for(let e=236;d.length<f;e^=236^17)s(e,8,d);let h=[];for(;h.length*8<d.length;)h.push(0);return d.forEach((e,t)=>h[t>>>3]|=e<<7-(t&7)),new t(u,i,h,c)}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),e=t.length;for(let n=0;n<e;n++)for(let s=0;s<e;s++)n==0&&s==0||n==0&&s==e-1||n==e-1&&s==0||this.drawAlignmentPattern(t[n],t[s]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const s=this.errorCorrectionLevel.formatBits<<3|e;let n=s;for(let e=0;e<10;e++)n=n<<1^(n>>>9)*1335;const t=(s<<10|n)^21522;o(t>>>15==0);for(let e=0;e<=5;e++)this.setFunctionModule(8,e,i(t,e));this.setFunctionModule(8,7,i(t,6)),this.setFunctionModule(8,8,i(t,7)),this.setFunctionModule(7,8,i(t,8));for(let e=9;e<15;e++)this.setFunctionModule(14-e,8,i(t,e));for(let e=0;e<8;e++)this.setFunctionModule(this.size-1-e,8,i(t,e));for(let e=8;e<15;e++)this.setFunctionModule(8,this.size-15+e,i(t,e));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let t=0;t<12;t++)e=e<<1^(e>>>11)*7973;const t=this.version<<12|e;o(t>>>18==0);for(let e=0;e<18;e++){const n=i(t,e),s=this.size-11+e%3,o=Math.floor(e/3);this.setFunctionModule(s,o,n),this.setFunctionModule(o,s,n)}}drawFinderPattern(e,t){for(let n=-4;n<=4;n++)for(let s=-4;s<=4;s++){const a=Math.max(Math.abs(s),Math.abs(n)),o=e+s,i=t+n;0<=o&&o<this.size&&0<=i&&i<this.size&&this.setFunctionModule(o,i,a!=2&&a!=4)}}drawAlignmentPattern(e,t){for(let n=-2;n<=2;n++)for(let s=-2;s<=2;s++)this.setFunctionModule(e+s,t+n,Math.max(Math.abs(s),Math.abs(n))!=1)}setFunctionModule(e,t,n){this.modules[t][e]=n,this.isFunction[t][e]=!0}addEccAndInterleave(e){const n=this.version,i=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(n,i))throw new RangeError("Invalid argument");const s=t.NUM_ERROR_CORRECTION_BLOCKS[i.ordinal][n],a=t.ECC_CODEWORDS_PER_BLOCK[i.ordinal][n],r=Math.floor(t.getNumRawDataModules(n)/8),c=s-r%s,u=Math.floor(r/s);let l=[];const h=t.reedSolomonComputeDivisor(a);for(let n=0,i=0;n<s;n++){let o=e.slice(i,i+u-a+(n<c?0:1));i+=o.length;const r=t.reedSolomonComputeRemainder(o,h);n<c&&o.push(0),l.push(o.concat(r))}let d=[];for(let e=0;e<l[0].length;e++)l.forEach((t,n)=>{(e!=u-a||n>=c)&&d.push(t[e])});return o(d.length==r),d}drawCodewords(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let n=0;for(let t=this.size-1;t>=1;t-=2){t==6&&(t=5);for(let s=0;s<this.size;s++)for(let o=0;o<2;o++){const a=t-o,c=(t+1&2)==0,r=c?this.size-1-s:s;!this.isFunction[r][a]&&n<e.length*8&&(this.modules[r][a]=i(e[n>>>3],7-(n&7)),n++)}}o(n==e.length*8)}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let n=0;n<this.size;n++){let s;switch(e){case 0:s=(n+t)%2==0;break;case 1:s=t%2==0;break;case 2:s=n%3==0;break;case 3:s=(n+t)%3==0;break;case 4:s=(Math.floor(n/3)+Math.floor(t/2))%2==0;break;case 5:s=n*t%2+n*t%3==0;break;case 6:s=(n*t%2+n*t%3)%2==0;break;case 7:s=((n+t)%2+n*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][n]&&s&&(this.modules[t][n]=!this.modules[t][n])}}getPenaltyScore(){let e=0;for(let s=0;s<this.size;s++){let o=!1,n=0,i=[0,0,0,0,0,0,0];for(let a=0;a<this.size;a++)this.modules[s][a]==o?(n++,n==5?e+=t.PENALTY_N1:n>5&&e++):(this.finderPenaltyAddHistory(n,i),o||(e+=this.finderPenaltyCountPatterns(i)*t.PENALTY_N3),o=this.modules[s][a],n=1);e+=this.finderPenaltyTerminateAndCount(o,n,i)*t.PENALTY_N3}for(let s=0;s<this.size;s++){let o=!1,n=0,i=[0,0,0,0,0,0,0];for(let a=0;a<this.size;a++)this.modules[a][s]==o?(n++,n==5?e+=t.PENALTY_N1:n>5&&e++):(this.finderPenaltyAddHistory(n,i),o||(e+=this.finderPenaltyCountPatterns(i)*t.PENALTY_N3),o=this.modules[a][s],n=1);e+=this.finderPenaltyTerminateAndCount(o,n,i)*t.PENALTY_N3}for(let n=0;n<this.size-1;n++)for(let s=0;s<this.size-1;s++){const o=this.modules[n][s];o==this.modules[n][s+1]&&o==this.modules[n+1][s]&&o==this.modules[n+1][s+1]&&(e+=t.PENALTY_N2)}let n=0;for(const e of this.modules)n=e.reduce((e,t)=>e+(t?1:0),n);const i=this.size*this.size,s=Math.ceil(Math.abs(n*20-i*10)/i)-1;return o(0<=s&&s<=9),e+=s*t.PENALTY_N4,o(0<=e&&e<=2568888),e}getAlignmentPatternPositions(){if(this.version==1)return[];const t=Math.floor(this.version/7)+2,n=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2;let e=[6];for(let s=this.size-7;e.length<t;s-=n)e.splice(1,0,s);return e}static getNumRawDataModules(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version number out of range");let n=(16*e+128)*e+64;if(e>=2){const t=Math.floor(e/7)+2;n-=(25*t-10)*t-55,e>=7&&(n-=36)}return o(208<=n&&n<=29648),n}static getNumDataCodewords(e,n){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[n.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[n.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw new RangeError("Degree out of range");let n=[];for(let t=0;t<e-1;t++)n.push(0);n.push(1);let s=1;for(let o=0;o<e;o++){for(let e=0;e<n.length;e++)n[e]=t.reedSolomonMultiply(n[e],s),e+1<n.length&&(n[e]^=n[e+1]);s=t.reedSolomonMultiply(s,2)}return n}static reedSolomonComputeRemainder(e,n){let s=n.map(e=>0);for(const o of e){const i=o^s.shift();s.push(0),n.forEach((e,n)=>s[n]^=t.reedSolomonMultiply(e,i))}return s}static reedSolomonMultiply(e,t){if(e>>>8!=0||t>>>8!=0)throw new RangeError("Byte out of range");let n=0;for(let s=7;s>=0;s--)n=n<<1^(n>>>7)*285,n^=(t>>>s&1)*e;return o(n>>>8==0),n}finderPenaltyCountPatterns(e){const t=e[1];o(t<=this.size*3);const n=t>0&&e[2]==t&&e[3]==t*3&&e[4]==t&&e[5]==t;return(n&&e[0]>=t*4&&e[6]>=t?1:0)+(n&&e[6]>=t*4&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,n){return e&&(this.finderPenaltyAddHistory(t,n),t=0),t+=this.size,this.finderPenaltyAddHistory(t,n),this.finderPenaltyCountPatterns(n)}finderPenaltyAddHistory(e,t){t[0]==0&&(e+=this.size),t.pop(),t.unshift(e)}}t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;function s(e,t,n){if(t<0||t>31||e>>>t!=0)throw new RangeError("Value out of range");for(let s=t-1;s>=0;s--)n.push(e>>>s&1)}function i(e,t){return(e>>>t&1)!=0}function o(e){if(!e)throw new Error("Assertion error")}class n{constructor(e,t,n){if(this.mode=e,this.numChars=t,this.bitData=n,t<0)throw new RangeError("Invalid argument");this.bitData=n.slice()}static makeBytes(e){let t=[];for(const n of e)s(n,8,t);return new n(n.Mode.BYTE,e.length,t)}static makeNumeric(e){if(!n.isNumeric(e))throw new RangeError("String contains non-numeric characters");let t=[];for(let n=0;n<e.length;){const o=Math.min(e.length-n,3);s(parseInt(e.substr(n,o),10),o*3+1,t),n+=o}return new n(n.Mode.NUMERIC,e.length,t)}static makeAlphanumeric(e){if(!n.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");let o=[],t;for(t=0;t+2<=e.length;t+=2){let i=n.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t))*45;i+=n.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t+1)),s(i,11,o)}return t<e.length&&s(n.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t)),6,o),new n(n.Mode.ALPHANUMERIC,e.length,o)}static makeSegments(e){return e==""?[]:n.isNumeric(e)?[n.makeNumeric(e)]:n.isAlphanumeric(e)?[n.makeAlphanumeric(e)]:[n.makeBytes(n.toUtf8ByteArray(e))]}static makeEci(e){let t=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<1<<7)s(e,8,t);else if(e<1<<14)s(2,2,t),s(e,14,t);else if(e<1e6)s(6,3,t),s(e,21,t);else throw new RangeError("ECI assignment value out of range");return new n(n.Mode.ECI,0,t)}static isNumeric(e){return n.NUMERIC_REGEX.test(e)}static isAlphanumeric(e){return n.ALPHANUMERIC_REGEX.test(e)}getData(){return this.bitData.slice()}static getTotalBits(e,t){let n=0;for(const s of e){const o=s.mode.numCharCountBits(t);if(s.numChars>=1<<o)return 1/0;n+=4+o+s.bitData.length}return n}static toUtf8ByteArray(e){e=encodeURI(e);let t=[];for(let n=0;n<e.length;n++)e.charAt(n)!="%"?t.push(e.charCodeAt(n)):(t.push(parseInt(e.substr(n+1,2),16)),n+=2);return t}}n.NUMERIC_REGEX=/^[0-9]*$/,n.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+./:-]*$/,n.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",e.QrSegment=n})(qrcodegen||(qrcodegen={})),function(e){var t;(function(e){class t{constructor(e,t){this.ordinal=e,this.formatBits=t}}t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),e.Ecc=t})(t=e.QrCode||(e.QrCode={}))}(qrcodegen||(qrcodegen={})),function(e){var t;(function(e){class t{constructor(e,t){this.modeBits=e,this.numBitsCharCount=t}numCharCountBits(e){return this.numBitsCharCount[Math.floor((e+7)/17)]}}t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),e.Mode=t})(t=e.QrSegment||(e.QrSegment={}))}(qrcodegen||(qrcodegen={}))